<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>DIMS â€” Desktop Side-by-Side</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{
  --bg:#eaf2ff;
  --panel:#ffffff;
  --line:#c9d9ff;
  --deep:#123a7a;
  --blue:#184a98;
  --gold:#f4d35e;
  --text:#0b1733;
  --muted:#5b6b8d;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif}
.page{max-width:1280px;margin:0 auto;padding:18px}
.topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.brand{display:flex;gap:10px;align-items:center}
.lion{font-size:1.8rem}
.titles h1{margin:0;color:var(--deep);font-size:1.25rem;letter-spacing:.3px}
.subtitle{color:var(--muted);font-size:.92rem}
.actions{display:flex;gap:8px}
button{background:var(--deep);color:#fff;border:1px solid var(--blue);padding:8px 12px;border-radius:8px;cursor:pointer}
button:hover{filter:brightness(1.06)}

.container{display:grid;grid-template-columns: 0.42fr 0.58fr; gap:16px; min-height:85vh}
.left{position:sticky; top:10px; align-self:start; height:max-content}
.card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:14px;box-shadow:0 1px 2px rgba(0,0,0,.03);margin-bottom:12px}
.card h2{margin:0 0 6px 0;color:var(--blue);font-size:1.06rem}
.nowword{font-size:1rem;line-height:1.5}
ul{margin:6px 0 0 20px}
.scripture{color:#7a5a00;font-style:italic;margin-top:8px}

.right{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:14px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
.right-head{display:flex;align-items:end;justify-content:space-between;gap:12px;flex-wrap:wrap;margin-bottom:8px}
.filters{display:flex;gap:10px;align-items:center}
label{font-size:.92rem;color:var(--muted)}
select{margin-left:6px;padding:8px 10px;border:1px solid var(--line);border-radius:8px;background:#fff;color:var(--text)}

.table-wrap{overflow:auto;border:1px solid var(--line);border-radius:12px}
table{width:100%;border-collapse:separate;border-spacing:0}
th,td{padding:10px 12px;text-align:left;border-bottom:1px solid var(--line)}
thead th{position:sticky;top:0;background:#f7faff;color:var(--deep);font-weight:700;cursor:pointer}
thead th.nosort{cursor:default}
tbody tr:hover{background:#f2f7ff}
td.taskname{max-width:520px}
.status,.priority,.stream{white-space:nowrap}

/* Clean icons: no tinted backgrounds */
.status{font-weight:600}
.priority{font-weight:600}
.stream{color:var(--muted)}

.legend{margin-top:12px;color:var(--muted);line-height:1.4;text-align:center;padding:8px;border-top:1px dashed var(--line)}
.legend div:first-child{font-weight:700;color:var(--deep);margin-bottom:2px}
.timestamp{margin-top:8px;color:var(--muted);font-size:.9rem;text-align:right}
.footnote{color:var(--muted);text-align:center;margin-top:16px;font-size:.9rem}
</style>

<style>
:root {
  --dom-blue: #0C1475;
  --dom-gold: #FFD700;
  --dom-text: #ffffff;
}
/* Brand overrides */
.sidebar, .left-nav, .tier-sidebar, nav { background: var(--dom-blue) !important; color: var(--dom-text) !important; }
.sidebar a, .left-nav a, nav a { color: var(--dom-text) !important; }
button, .btn { background: var(--dom-blue); color: var(--dom-text); border: 1px solid rgba(255,255,255,.15); }
button:hover, .btn:hover { outline: 2px solid var(--dom-gold); }
.section-title, h2, h3 { color: var(--dom-blue); }
.gold-accent { color: var(--dom-gold) !important; }
.nav-item-teachings { display:block; width:100%; text-align:left; margin:8px 0 0; padding:10px 12px; background:var(--dom-blue); color:#fff; border:1px solid rgba(255,255,255,.2); border-radius:8px; }
.nav-item-teachings:hover { background:#101b8f; box-shadow: 0 0 0 2px var(--dom-gold) inset; }
/* Teachings view */
#view-teachings { display:none; padding:16px; }
#view-teachings .toolbar { display:flex; gap:8px; align-items:center; margin-bottom:8px }
#view-teachings .toolbar .spacer { flex:1 1 auto }
#view-teachings .split { display:grid; grid-template-columns: 300px 1fr; gap:12px }
#view-teachings .list { border-right:1px solid #e6e9ef; padding-right:12px; overflow:auto; background:#fff; border-radius:8px }
#view-teachings .title { width:100%; font-size:1.15rem; margin:6px 0 }
#view-teachings .preview { border:1px solid #e6e9ef; border-radius:8px; padding:12px; margin-top:8px; background:#fff }
@media print {
  .sidebar, nav, .toolbar, .list, .title, select, input, .back-dash { display:none !important; }
  body { background:#fff; }
  #teaching-preview { border:none; padding:0; }
}
</style>

</head>
<body>
<div class="page">
  <header class="topbar">
    <div class="brand">
      <div class="lion">ğŸ¦</div>
      <div class="titles">
        <h1>DIMS â€” Prophetic â€¢ Desktop</h1>
        <div class="subtitle">Dominion1st â€¢ OrEl</div>
      </div>
    </div>
    <div class="actions">
      <button id="btnRefresh">ğŸ”„ Refresh Prophetic</button>
      <button id="btnPrint">â¬‡ï¸ Export to PDF</button>
    </div>
  </header>

  <div class="container">
    <!-- LEFT: Prophetic column -->
    <aside class="left">
<button id="nav-teachings" class="nav-item-teachings">ğŸ“œ Teachings</button>

      <section class="card">
        <h2>ğŸ•Šï¸ Prophetic Word</h2>
        <p id="propheticWord" class="nowword">I am turning resistance into runway. Step forwardâ€”doors are opening in sequence as you move.</p>
      </section>
      <section class="card">
        <h2>ğŸŒ Tier 1 â€” World Intel</h2>
        <ul id="tier1"></ul>
      </section>
      <section class="card">
        <h2>ğŸ”— Tier 2 â€” Bridge Intel</h2>
        <ul id="tier2"></ul>
      </section>
      <section class="card">
        <h2>ğŸ™Œ Tier 3 â€” Personal/Ministry Intel</h2>
        <p id="tier3"></p>
        <p id="scripture" class="scripture"></p>
      </section>
    </aside>

    <!-- RIGHT: Dashboard column -->
    <section class="right">
      <div class="right-head">
        <h2>ğŸ“Š Dashboard â€” Top Tasks</h2>
        <div class="filters">
          <label>Status
            <select id="filterStatus">
              <option value="ALL">All</option>
              <option value="Open">Open</option>
              <option value="In Progress">In Progress</option>
              <option value="Closed">Closed</option>
            </select>
          </label>
          <label>Priority
            <select id="filterPriority">
              <option value="ALL">All</option>
              <option value="High">High</option>
              <option value="Medium">Medium</option>
              <option value="Low">Low</option>
            </select>
          </label>
          <label>Stream
            <select id="filterStream">
              <option value="ALL">All</option>
            </select>
          </label>
        </div>
      </div>

      <div class="table-wrap">
        <table id="taskTable">
          <thead>
            <tr>
              <th class="nosort">#</th>
              <th data-key="name">Task</th>
              <th data-key="status">Status</th>
              <th data-key="priorityRank">Priority</th>
              <th data-key="stream">Stream</th>
            </tr>
          </thead>
          <tbody id="taskRows"></tbody>
        </table>
      </div>

      <div class="legend">
        <div>ğŸ“ Legend</div>
        <div>Status: <span>ğŸŸ¢ Open</span> Â· <span>ğŸŸ¡ In Progress</span> Â· <span>ğŸ”´ Closed</span></div>
        <div>Priority: <span>ğŸ‘‘ High</span> Â· <span>ğŸ›¡ Medium</span> Â· <span>ğŸ—¡ Low</span></div>
      </div>
      <div class="timestamp">Updated <span id="ts"></span></div>
    </section>
  </div>

  <footer class="footnote">Â© Dominion1st â€¢ DIMS Prophetic â€¢ Desktop Mock</footer>
</div>

<script>
let CFG={
  tasks:[
    {id:1,name:"Trademark Filing",status:"In Progress",priority:"High",stream:"Branding & Design"},
    {id:2,name:"508(c)(1)(a) Setup",status:"Open",priority:"High",stream:"Projects & Tasks"},
    {id:3,name:"IRS Crypto Taxes (2024)",status:"Open",priority:"High",stream:"Projects & Tasks"},
    {id:4,name:"IRA Financial Transition",status:"Open",priority:"Medium",stream:"Projects & Tasks"},
    {id:5,name:"Divine DI Origin Story â€” Vision & Mission",status:"In Progress",priority:"High",stream:"Divine Core Framework"},
    {id:6,name:"Well & Decree Library Expansion",status:"Open",priority:"Medium",stream:"Wells & Decree Library"},
    {id:7,name:"Milestone Chronicle Development",status:"Open",priority:"Medium",stream:"Prophetic Systems"},
    {id:8,name:"Prophecy Flow Integration (Wells & Decrees)",status:"Open",priority:"Medium",stream:"Prophetic Systems"},
    {id:9,name:"KuberNÄ“sis Dashboard Refinement",status:"In Progress",priority:"High",stream:"Prophetic Systems"},
    {id:10,name:"Lion Emblem & Branding Finalization",status:"Open",priority:"Medium",stream:"Branding & Design"}
  ],
  scriptures:[
    {ref:"Isaiah 60:1",text:"Arise, shine; for your light has come, and the glory of the LORD has risen upon you."},
    {ref:"Job 22:28",text:"You shall also decree a thing, and it shall be established; and light shall shine upon your ways."},
    {ref:"Romans 8:37",text:"In all these things we are more than conquerors through Him who loved us."},
    {ref:"1 John 5:4",text:"This is the victory that overcomes the world, even our faith."}
  ]
};

const worldSignalsPool=[
  {domain:'finance',text:'Global compliance pressure rising; markets remain volatile.'},
  {domain:'governance',text:'Religious speech & nonprofits face heightened scrutiny.'},
  {domain:'tech',text:'AI acceleration reshapes communication, reach, and oversight.'},
  {domain:'culture',text:'Polarization increases; truth-telling voices gain unusual favor.'},
  {domain:'media',text:'Short-form messaging dominates; clarity and visuals carry impact.'}
];
const priorityOrder={'High':1,'Medium':2,'Low':3};

let filters={status:'ALL',priority:'ALL',stream:'ALL'};
let sortKey=null, sortDir=1; // 1 asc, -1 desc

function statusText(s){
  if(s==='Open') return 'ğŸŸ¢ Open';
  if(s==='In Progress') return 'ğŸŸ¡ In Progress';
  return 'ğŸ”´ Closed';
}
function priorityText(p){
  if(p==='High') return 'ğŸ‘‘ High';
  if(p==='Medium') return 'ğŸ›¡ Medium';
  return 'ğŸ—¡ Low';
}

function applyFilters(tasks){
  return tasks.filter(t=>
    (filters.status==='ALL'||t.status===filters.status) &&
    (filters.priority==='ALL'||t.priority===filters.priority) &&
    (filters.stream==='ALL'||t.stream===filters.stream)
  );
}
function applySort(tasks){
  if(!sortKey) return tasks;
  const dir=sortDir;
  return tasks.slice().sort((a,b)=>{
    const va=(sortKey==='priorityRank') ? priorityOrder[a.priority] : a[sortKey];
    const vb=(sortKey==='priorityRank') ? priorityOrder[b.priority] : b[sortKey];
    if(va<vb) return -1*dir;
    if(va>vb) return 1*dir;
    return 0;
  });
}
function renderTasks(){
  const tbody=document.getElementById('taskRows');
  let list=applyFilters(CFG.tasks);
  if(sortKey){ list=applySort(list); }
  tbody.innerHTML=list.map(t=>`
    <tr>
      <td>${t.id}</td>
      <td class="taskname">${t.name}</td>
      <td class="status">${statusText(t.status)}</td>
      <td class="priority">${priorityText(t.priority)}</td>
      <td class="stream">${t.stream}</td>
    </tr>
  `).join('');
}
function refreshTiers(){
  // Tier 1: pick 3
  const picks=[...worldSignalsPool].sort(()=>Math.random()-0.5).slice(0,3);
  document.getElementById('tier1').innerHTML=picks.map(x=>`<li>${x.text}</li>`).join('');
  // Tier 2: Bridge to top priorities
  const active=CFG.tasks.filter(t=>t.status!=='Closed').sort((a,b)=>priorityOrder[a.priority]-priorityOrder[b.priority]);
  const lines=[];
  if(picks[0]&&active[0]) lines.push(`Shifts in ${picks[0].domain} affirm prioritizing ${active[0].name}.`);
  if(picks[1]&&active[1]) lines.push(`${picks[1].domain} pressure links to ${active[1].name}â€”secure it now.`);
  if(picks[2]&&active[2]) lines.push(`Acceleration in ${picks[2].domain} favors momentum on ${active[2].name}.`);
  document.getElementById('tier2').innerHTML = (lines.length?lines:[`Hold your top priorities steady; momentum is compounding.`]).map(x=>`<li>${x}</li>`).join('');
  // Tier 3: Personal line + scripture
  const personals=[
    'I am synchronizing your steps with favor and accuracy.',
    'Finish what I placed in your hand; it becomes refuge for many.',
    'Do not hesitateâ€”move with measured boldness and decree increase.',
    'Guard your focus; acceleration meets alignment.'
  ];
  document.getElementById('tier3').textContent = personals[Math.floor(Math.random()*personals.length)];
  const scr=CFG.scriptures[Math.floor(Math.random()*CFG.scriptures.length)];
  document.getElementById('scripture').textContent=`â€œ${scr.text}â€ (${scr.ref})`;
}
function initFilters(){
  const selS=document.getElementById('filterStatus');
  const selP=document.getElementById('filterPriority');
  const selSt=document.getElementById('filterStream');
  const streams=[...new Set(CFG.tasks.map(t=>t.stream))].sort();
  streams.forEach(s=>{ const o=document.createElement('option'); o.value=s; o.textContent=s; selSt.appendChild(o); });
  selS.addEventListener('change',e=>{filters.status=e.target.value; renderTasks();});
  selP.addEventListener('change',e=>{filters.priority=e.target.value; renderTasks();});
  selSt.addEventListener('change',e=>{filters.stream=e.target.value; renderTasks();});
}
function initSort(){
  document.querySelectorAll('thead th').forEach(th=>{
    if(th.classList.contains('nosort')) return;
    th.addEventListener('click',()=>{
      const key=th.getAttribute('data-key')||th.getAttribute('data-key')||th.dataset.key;
      if(sortKey===key){ sortDir*=-1; } else { sortKey=key; sortDir=1; }
      renderTasks();
    });
  });
}
function stamp(){
  const d=new Date(), p=n=>String(n).padStart(2,'0');
  return d.getFullYear()+"-"+p(d.getMonth()+1)+"-"+p(d.getDate())+" "+p(d.getHours())+":"+p(d.getMinutes());
}
document.getElementById('btnRefresh').addEventListener('click',()=>{ refreshTiers(); document.getElementById('ts').textContent=stamp(); });
document.getElementById('btnPrint').addEventListener('click',()=>window.print());

// init
refreshTiers();
initFilters();
initSort();
renderTasks();
document.getElementById('ts').textContent=stamp();
</script>

<section id="view-teachings">
  <header class="toolbar">
    <h2 class="gold-accent" style="margin:0">ğŸ“œ Teachings</h2>
    <span class="spacer"></span>
    <button class="back-dash" id="btn-back-dash">â† Back to Dashboard</button>
  </header>

  <div class="toolbar">
    <button id="btn-new-teaching">New</button>
    <button id="btn-save-teaching">Save</button>
    <button id="btn-preview-teaching">Preview</button>
    <button id="btn-print-teaching">Print</button>
    <span class="spacer"></span>
    <label><input type="checkbox" id="chk-public"> Public</label>
    <input id="teaching-search" placeholder="Search title, tag, scriptureâ€¦" style="margin-left:8px">
  </div>

  <div class="split">
    <aside class="list">
      <ul id="teaching-list" style="list-style:none;margin:0;padding:8px"></ul>
    </aside>

    <main class="editor">
      <input id="teaching-title" class="title" placeholder="Title">
      <div style="display:flex; gap:8px; margin-bottom:8px">
        <select id="teaching-status">
          <option value="open">ğŸŸ¢ Open</option>
          <option value="in_progress">ğŸŸ¡ In Progress</option>
          <option value="closed">ğŸ”´ Closed</option>
        </select>
        <select id="teaching-priority">
          <option value="high">ğŸ‘‘ High</option>
          <option value="medium">ğŸ›¡ Medium</option>
          <option value="low">ğŸš‹ Low</option>
        </select>
        <input id="teaching-tags" placeholder="tags (comma separated)" style="flex:1">
      </div>
      <textarea id="teaching-md" rows="18" placeholder="Use Markdown. Italicize scripture and include refs in parentheses." style="width:100%"></textarea>
      <div id="teaching-preview" class="preview" style="display:none"></div>
    </main>
  </div>
</section>

</body>
</html>

<script>
(function(){
  function $(s){ return document.querySelector(s); }
  function statusBadge(s){ return s==='open'?'ğŸŸ¢ Open':s==='in_progress'?'ğŸŸ¡ In Progress':'ğŸ”´ Closed';}
  function prioBadge(p){ return p==='high'?'ğŸ‘‘ High':p==='medium'?'ğŸ›¡ Medium':'ğŸš‹ Low';}

  let TEACHINGS = [];
  let currentId = null;

  async function loadTeachings(){
    try{
      const res = await fetch('teachings.json', {cache:'no-store'});
      const data = await res.json();
      TEACHINGS = data.teachings || [];
      renderTeachingList();
      if(TEACHINGS.length) setEditor(TEACHINGS[0]);
    }catch(e){
      TEACHINGS = []; renderTeachingList();
    }
  }

  function renderTeachingList(filter=''){
    const ul = document.getElementById('teaching-list');
    const q = (filter||'').toLowerCase().trim();
    ul.innerHTML = '';
    TEACHINGS
      .filter(t => !q || [t.title, ...(t.tags||[]), ...(t.scriptures||[]).map(s=>s.ref)].join(' ').toLowerCase().includes(q))
      .sort((a,b)=>a.title.localeCompare(b.title))
      .forEach(t=>{
        const li = document.createElement('li');
        li.style.margin='6px 0';
        li.innerHTML = `<button class="teaching-row" data-id="${t.id}" style="width:100%;text-align:left;padding:8px;border:1px solid #e6e9ef;border-radius:8px;background:#fff">
          <div style="font-weight:600">${t.title}</div>
          <div style="color:#5b6b7a">${statusBadge(t.status)} Â· ${prioBadge(t.priority)} ${t.public ? 'Â· ğŸŒ Public' : 'Â· ğŸ”’ Private'}</div>
        </button>`;
        ul.appendChild(li);
      });
  }

  function setEditor(t){
    currentId = t.id;
    $('#teaching-title').value = t.title||'';
    $('#teaching-status').value = t.status||'open';
    $('#teaching-priority').value = t.priority||'high';
    $('#teaching-tags').value = (t.tags||[]).join(', ');
    $('#teaching-md').value = t.content_md||'';
    $('#chk-public').checked = !!t.public;
    const pv = document.getElementById('teaching-preview'); if(pv) pv.style.display='none';
  }

  function getEditor(){
    return {
      id: currentId,
      title: $('#teaching-title').value.trim(),
      status: $('#teaching-status').value,
      priority: $('#teaching-priority').value,
      tags: $('#teaching-tags').value.split(',').map(s=>s.trim()).filter(Boolean),
      content_md: $('#teaching-md').value,
      public: $('#chk-public').checked,
      updated_at: new Date().toISOString()
    };
  }

  function newTeaching(){
    currentId = 'tch-' + Date.now();
    setEditor({id:currentId, title:'', status:'open', priority:'high', tags:[], scriptures:[], content_md:'', public:false});
  }

  function saveTeaching(){
    const draft = getEditor();
    localStorage.setItem('dims_teaching_' + draft.id, JSON.stringify(draft));
    const i = TEACHINGS.findIndex(t=>t.id===draft.id);
    if(i>=0) TEACHINGS[i] = Object.assign(TEACHINGS[i], draft);
    else TEACHINGS.push(draft);
    renderTeachingList(document.getElementById('teaching-search')?.value || '');
    alert('Teaching saved locally. (Publishing to file requires a build/deploy step.)');
  }

  function renderTeachingHTML(t){
    const md = (t.content_md||'')
      .replace(/^### (.*)$/gm,'<h3>$1</h3>')
      .replace(/^## (.*)$/gm,'<h2>$1</h2>')
      .replace(/^# (.*)$/gm,'<h1>$1</h1>')
      .replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>')
      .replace(/\*(.*?)\*/g,'<em>$1</em>')
      .replace(/\n/g,'<br>');
    const scriptures = (t.scriptures||[]).map(s=>`<li><em>${s.text}</em> <span>(${s.ref})</span></li>`).join('');
    const scripturesBlock = scriptures ? `<section><h3>Scriptures</h3><ul>${scriptures}</ul></section>` : '';
    return `
      <article class="teaching">
        <header><h1>${t.title||'(Untitled Teaching)'}</h1>
          <div class="meta">${statusBadge(t.status)} Â· ${prioBadge(t.priority)} ${t.public?'Â· ğŸŒ Public':'Â· ğŸ”’ Private'}</div>
        </header>
        ${scripturesBlock}
        <section>${md}</section>
      </article>`;
  }

  function previewTeaching(){
    const t = getEditor();
    const html = renderTeachingHTML(t);
    const box = document.getElementById('teaching-preview');
    box.innerHTML = html;
    box.style.display='block';
  }

  function printTeaching(){
    previewTeaching();
    window.print();
  }

  function showTeachingsView(){
    const v = document.getElementById('view-teachings');
    if(v) v.style.display='block';
    document.querySelectorAll('main, section').forEach(el=>{
      if(el.id !== 'view-teachings'){
        if(el.closest && el.closest('#view-teachings')) return;
        if(el.className && /sidebar|left|nav/i.test(el.className)) return;
        if(el.id && el.id==='view-teachings') return;
        el.style.display = 'none';
      }
    });
    window.scrollTo(0,0);
  }
  function backToDashboard(){
    const v = document.getElementById('view-teachings');
    if(v) v.style.display='none';
    document.querySelectorAll('main, section').forEach(el=>{
      if(el.id !== 'view-teachings') el.style.display = '';
    });
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    loadTeachings();
    const btn = document.getElementById('nav-teachings');
    if(btn) btn.addEventListener('click', showTeachingsView);
    const back = document.getElementById('btn-back-dash');
    if(back) back.addEventListener('click', backToDashboard);
    document.getElementById('btn-new-teaching').addEventListener('click', newTeaching);
    document.getElementById('btn-save-teaching').addEventListener('click', saveTeaching);
    document.getElementById('btn-preview-teaching').addEventListener('click', previewTeaching);
    document.getElementById('btn-print-teaching').addEventListener('click', printTeaching);
    document.getElementById('teaching-search').addEventListener('input', e=>renderTeachingList(e.target.value));
    document.getElementById('teaching-list').addEventListener('click', e=>{
      const btn = e.target.closest('.teaching-row'); if(!btn) return;
      const t = TEACHINGS.find(x=>x.id===btn.dataset.id);
      if(t) setEditor(t);
    });
  });
})();
</script>
